---
import { getCollection } from 'astro:content';

const platforms = await getCollection('platforms');
const sortedPlatforms = platforms.sort((a, b) => (a.data.order || 0) - (b.data.order || 0));

// Map collection data to display properties (colors, images, etc.)
// These visual properties could also be moved to frontmatter if desired, 
// but for now we'll map them here to keep the content files simple.
const platformStyles = {
  'ParOne Dev': {
    image: "https://images.unsplash.com/photo-1770734360042-676ef707d022?auto=format&w=600&q=80",
    color: "group-hover:text-blue-400",
    badge: null
  },
  'ParOne Holdings': {
    image: "https://images.unsplash.com/photo-1762278804923-37f066f5e834?auto=format&w=600&q=80",
    color: "group-hover:text-blue-400",
    badge: null
  },
  'AVA Golf': {
    image: "https://images.unsplash.com/photo-1719345539016-f84748d48e37?auto=format&w=600&q=80",
    color: "group-hover:text-blue-400",
    badge: "Coming Soon"
  },
  'GolfCentral.tv': {
    image: "https://images.unsplash.com/photo-1644697066547-dd2e36e0bdc9?auto=format&w=600&q=80",
    color: "group-hover:text-blue-400",
    badge: "Coming Soon"
  },
  'ParOne App': {
    image: "https://images.unsplash.com/photo-1564049489314-60d154ff107d?auto=format&w=600&q=80",
    color: "group-hover:text-blue-400",
    badge: null
  }
};

const displayPlatforms = sortedPlatforms.map(p => {
  const styles = platformStyles[p.data.title] || { 
    image: "https://images.unsplash.com/photo-1500932334442-8761ee4810a7?auto=format&w=600&q=80", 
    color: "group-hover:text-white",
    badge: null
  };
  
  return {
    ...p.data,
    ...styles
  };
});
---

<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4" data-ps="src/components/PlatformCards.astro:root">
  {displayPlatforms.map((platform) => (
    <a href={platform.url || "#"} class="group relative h-[280px] overflow-hidden bg-[#1e293b] border border-white/5 hover:z-10 transition-all rounded-xl" data-ps="src/components/PlatformCards.astro:card">
      <!-- Image Background -->
      <div class="absolute inset-0 opacity-30 group-hover:opacity-10 transition-opacity duration-700" data-ps="src/components/PlatformCards.astro:img-bg">
        <img 
          crossorigin="anonymous"
          src={platform.image}
          alt={platform.title}
          class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-700 transform scale-105 group-hover:scale-110"
          loading="lazy" data-ps="src/components/PlatformCards.astro:img" />
      </div>
      
      <!-- Overlay Gradients -->
      <div class="absolute inset-0 bg-gradient-to-t from-[#0f172a] via-[#0f172a]/70 to-transparent" data-ps="src/components/PlatformCards.astro:overlay"></div>

      <!-- Content -->
      <div class="absolute inset-0 p-8 flex flex-col justify-end" data-ps="src/components/PlatformCards.astro:content">
        <div class="transform translate-y-2 group-hover:translate-y-0 transition-transform duration-500" data-ps="src/components/PlatformCards.astro:anim-wrapper">
          <div class="h-6 mb-2 flex items-center" data-ps="src/components/PlatformCards.astro:badge-container">
            {platform.badge && (
              <span class="inline-block px-2 py-0.5 bg-blue-500 text-white text-[9px] font-black uppercase tracking-widest rounded-sm" data-ps="src/components/PlatformCards.astro:badge">
                {platform.badge}
              </span>
            )}
          </div>
          <h3 class={`text-xl font-bold text-white mb-2 ${platform.color} transition-colors duration-300 leading-tight truncate`} data-ps="src/components/PlatformCards.astro:title">
            {platform.title}
          </h3>
          <p class="text-[13px] leading-relaxed text-slate-400 group-hover:text-white transition-colors duration-300 line-clamp-2 h-10" data-ps="src/components/PlatformCards.astro:desc">
            {platform.description}
          </p>
          <div class="mt-4 flex items-center gap-2 text-blue-400 opacity-0 group-hover:opacity-100 transition-opacity duration-300 transform translate-x-[-10px] group-hover:translate-x-0" data-ps="src/components/PlatformCards.astro:cta">
            <span class="text-[10px] font-bold uppercase tracking-wider" data-ps="src/components/PlatformCards.astro:cta-text">Explore</span>
            <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
            </svg>
          </div>
        </div>
      </div>
    </a>
  ))}
</div>
