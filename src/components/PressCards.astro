---
import { getCollection } from 'astro:content';

interface Props {
  limit?: number;
  featuredOnly?: boolean;
}

const { limit } = Astro.props;

const allPress = await getCollection('press');
// Sort by date (assuming standard string format can be parsed, or implement custom sort)
// Since date format is "Month DD, YYYY", we need to parse it carefully or store as date object in frontmatter
// For now, let's just reverse them as they seem to be added chronologically or rely on filename order if not sorted
// Better: parse the date string
const sortedPress = allPress.sort((a, b) => {
  return new Date(b.data.date).getTime() - new Date(a.data.date).getTime();
});

const displayPress = limit ? sortedPress.slice(0, limit) : sortedPress;
---

<div class="grid grid-cols-1 md:grid-cols-3 gap-8" data-ps="src/components/PressCards.astro:root">
  {displayPress.map((item) => (
    <a href="/press" class="group block bg-[#0f172a] border border-white/5 overflow-hidden hover:border-blue-500/30 transition-colors rounded-xl flex flex-col h-full" data-ps="src/components/PressCards.astro:card">
      <div class="h-48 w-full overflow-hidden relative" data-ps="src/components/PressCards.astro:img-container">
        <img src={item.data.image} alt={item.data.title} class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500 opacity-80 group-hover:opacity-100" data-ps="src/components/PressCards.astro:img" />
        <div class="absolute inset-0 bg-gradient-to-t from-[#0f172a] to-transparent" data-ps="src/components/PressCards.astro:overlay"></div>
      </div>
      <div class="p-8 flex flex-col flex-grow" data-ps="src/components/PressCards.astro:content">
        <span class="text-xs text-blue-400 font-bold uppercase tracking-wider mb-4 block" data-ps="src/components/PressCards.astro:tag">News</span>
        <h3 class="text-xl font-bold text-white mb-4 group-hover:text-blue-400 transition-colors line-clamp-3" data-ps="src/components/PressCards.astro:title">
          {item.data.title}
        </h3>
        <p class="text-slate-400 text-sm mb-6 line-clamp-3 flex-grow" data-ps="src/components/PressCards.astro:desc">
          {item.data.summary}
        </p>
        <div class="text-slate-500 text-xs flex items-center gap-2 mt-auto" data-ps="src/components/PressCards.astro:meta">
          <span data-ps="src/components/PressCards.astro:date">{item.data.date}</span>
          <span class="w-1 h-1 bg-slate-700 rounded-full" data-ps="src/components/PressCards.astro:dot"></span>
          <span data-ps="src/components/PressCards.astro:type">Press Release</span>
        </div>
      </div>
    </a>
  ))}
</div>
